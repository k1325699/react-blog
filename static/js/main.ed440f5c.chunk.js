(this["webpackJsonpreact-blog"]=this["webpackJsonpreact-blog"]||[]).push([[0],{28:function(n,e,t){},29:function(n,e,t){},30:function(n,e,t){},43:function(n,e,t){"use strict";t.r(e);var a,r,c,o,i,s,d,b,p=t(0),u=t(19),j=t.n(u),l=(t(28),t(29),t(5)),x=t(2),f=(t(30),t(3)),h=t(6),O=t(4),g=Object(p.createContext)(null),m="token",v=function(n){localStorage.setItem(m,n)},w=function(){return localStorage.getItem(m)},y=t(9),k=t.n(y),S=t(10),C="https://student-json-api.lidemy.me",z=function(){var n=Object(S.a)(k.a.mark((function n(){var e,t;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(C,"/posts?_sort=createdAt&_order=desc"));case 2:return e=n.sent,n.next=5,e.json();case 5:return t=n.sent,n.abrupt("return",t);case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),P=function(){var n=Object(S.a)(k.a.mark((function n(e){var t,a;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(C,"/posts?id=").concat(e));case 2:return t=n.sent,n.next=5,t.json();case 5:return a=n.sent,n.abrupt("return",a);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),F=function(){var n=Object(S.a)(k.a.mark((function n(e,t){var a;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(C,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,password:t})});case 2:return a=n.sent,n.next=5,a.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),I=function(){var n=Object(S.a)(k.a.mark((function n(e,t,a){var r;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(C,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,nickname:t,password:a})});case 2:return r=n.sent,n.next=5,r.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}(),D=function(){var n=Object(S.a)(k.a.mark((function n(){var e,t,a;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=w(),n.next=3,fetch("".concat(C,"/me"),{headers:{authorization:"Bearer ".concat(e)}});case 3:return t=n.sent,n.next=6,t.json();case 6:return a=n.sent,n.abrupt("return",a);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),L=function(){var n=Object(S.a)(k.a.mark((function n(e,t){var a,r;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=w(),n.next=3,fetch("".concat(C,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(a),"content-type":"application/json"},body:JSON.stringify({title:e,body:t})});case 3:return r=n.sent,n.next=6,r.json();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),E=t(1),J=f.a.div(a||(a=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 30px;\n  min-height: calc(100vh - 64px);\n"]))),N=f.a.div(r||(r=Object(x.a)(["\n  border: 1px solid #bc8cf2;\n  padding: 16px;\n  border-radius: 5px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  & + & {\n    margin-top: 15px;\n  }\n"]))),T=Object(f.a)(h.b)(c||(c=Object(x.a)(["\n  width: 80%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n  line-height: 1.5;\n"]))),U=f.a.div(o||(o=Object(x.a)(["\n  /* width: 20%; */\n  color: rgba(0, 0, 0, 0.8);\n"])));function B(n){var e=n.post;return Object(E.jsxs)(N,{children:[Object(E.jsx)(T,{to:"/post/".concat(e.id),children:e.title}),Object(E.jsx)(U,{children:new Date(e.createdAt).toLocaleString()})]})}function $(n){var e=n.num,t=n.totalPage,a=n.handlePrePageChage,r=n.handleNextPageChage;return Object(E.jsxs)(Q,{children:[1!==e&&Object(E.jsx)(V,{onClick:a,children:"\uff1c"}),Object(E.jsxs)(W,{children:[Object(E.jsx)(Y,{children:e})," / ",t]}),e!==t&&Object(E.jsx)(V,{onClick:r,children:"\uff1e"})]})}var A,_,M,R,X,q,G,H,K,Q=f.a.div(i||(i=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 20px;\n  margin-top: 20px;\n"]))),V=f.a.button(s||(s=Object(x.a)(["\n  border: none;\n  color: #aa14f0;\n  background: none;\n  font-size: 20px;\n  padding: 15px;\n  cursor: pointer;\n"]))),W=f.a.p(d||(d=Object(x.a)([""]))),Y=f.a.span(b||(b=Object(x.a)(["\n  color: #bc8cf2;\n"])));function Z(){var n=Object(p.useState)([]),e=Object(l.a)(n,2),t=e[0],a=e[1],r=Object(p.useState)(1),c=Object(l.a)(r,2),o=c[0],i=c[1],s=Object(p.useState)([]),d=Object(l.a)(s,2),b=d[0],u=d[1],j=t.filter((function(n){return n.title.length>=20})).length,x=Math.ceil(j/10);t.map((function(n){return console.log(n.title.length)}));var f=Object(p.useCallback)((function(n,e){u(t.filter((function(n){return n.title.length>=20})).slice((n-1)*e,(n-1)*e+e))}),[t]);Object(p.useLayoutEffect)((function(){z().then((function(n){return a(n)}))}),[]),Object(p.useEffect)((function(){f(o,10)}),[f,o]);return Object(E.jsxs)(J,{children:[b.map((function(n){return Object(E.jsx)(B,{post:n},n.id)})),Object(E.jsx)($,{num:o,totalPage:x,handlePrePageChage:function(){i(o-1)},handleNextPageChage:function(){i(o+1)}})]})}var nn,en,tn,an,rn,cn,on,sn,dn,bn=f.a.div(A||(A=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 15px;\n  margin-bottom: 30px;\n  display: flex;\n  justify-content: center;\n  align-items: baseline;\n  min-height: calc(100vh - 64px);\n"]))),pn=f.a.form(_||(_=Object(x.a)(["\n  width: 50%;\n  padding: 30px 15px 15px;\n  border: 1px solid #bc8cf2;\n  border-radius: 5px;\n"]))),un=f.a.h2(M||(M=Object(x.a)(["\n  border-left: 5px solid #e56bfa;\n  font-size: 28px;\n  font-weight: bold;\n  padding-left: 15px;\n  margin-bottom: 30px;\n"]))),jn=f.a.label(R||(R=Object(x.a)(["\n  display: block;\n  padding-bottom: 15px;\n"]))),ln=f.a.input(X||(X=Object(x.a)(["\n  width: 100%;\n  font-size: 18px;\n  padding: 5px;\n  margin-bottom: 15px;\n  outline: none;\n  border-radius: 5px;\n  border: 1px solid #000;\n"]))),xn=f.a.div(q||(q=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n"]))),fn=f.a.p(G||(G=Object(x.a)(["\n  color: red;\n  font-size: 18px;\n"]))),hn=f.a.button(H||(H=Object(x.a)(["\n  padding: 15px 25px;\n  border-radius: 5px;\n  box-shadow: none;\n  border: 1px solid #aa14f0;\n  background: #fff;\n  margin-left: 30px;\n  margin-bottom: 15px;\n  &:hover {\n    background: #aa14f0;\n    color: #fff;\n    cursor: pointer;\n  }\n"]))),On=Object(f.a)(h.b)(K||(K=Object(x.a)(["\n  margin-top: 15px;\n  margin-bottom: 15px;\n  padding: 10px 0;\n  display: block;\n  text-align: center;\n  text-decoration: none;\n  color: red;\n  font-size: 18px;\n"])));function gn(){var n=Object(p.useContext)(g).setUser,e=Object(O.f)(),t=Object(p.useState)(""),a=Object(l.a)(t,2),r=a[0],c=a[1],o=Object(p.useState)(""),i=Object(l.a)(o,2),s=i[0],d=i[1],b=Object(p.useState)(""),u=Object(l.a)(b,2),j=u[0],x=u[1];return Object(E.jsx)(bn,{children:Object(E.jsxs)(pn,{onSubmit:function(t){t.preventDefault(),F(r,s).then((function(t){if(0===t.ok)return x(t.message);v(t.token),D().then((function(t){if(1!==t.ok)return localStorage.removeItem("token"),x(t.toString());n(t.data),e.push("/")}))}))},children:[Object(E.jsx)(un,{children:"\u767b\u5165"}),Object(E.jsx)(jn,{htmlFor:"username",children:"\u5e33\u865f"}),Object(E.jsx)(ln,{type:"text",id:"username",value:r,onChange:function(n){c(n.target.value)}}),Object(E.jsx)(jn,{htmlFor:"password",children:"\u5bc6\u78bc"}),Object(E.jsx)(ln,{type:"password",id:"password",value:s,onChange:function(n){d(n.target.value)}}),Object(E.jsxs)(xn,{children:[j&&Object(E.jsx)(fn,{children:j}),Object(E.jsx)(hn,{children:"\u767b\u5165"})]}),Object(E.jsx)("hr",{}),Object(E.jsx)(On,{to:"/register",children:"\u524d\u5f80\u8a3b\u518a"})]})})}var mn,vn,wn,yn,kn,Sn,Cn=f.a.div(nn||(nn=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 15px;\n  margin-bottom: 30px;\n  display: flex;\n  justify-content: center;\n  align-items: baseline;\n  min-height: calc(100vh - 64px);\n"]))),zn=f.a.form(en||(en=Object(x.a)(["\n  width: 50%;\n  padding: 30px 15px 15px;\n  border: 1px solid #bc8cf2;\n  border-radius: 5px;\n"]))),Pn=f.a.h2(tn||(tn=Object(x.a)(["\n  border-left: 5px solid #e56bfa;\n  font-size: 28px;\n  font-weight: bold;\n  padding-left: 15px;\n  margin-bottom: 30px;\n"]))),Fn=f.a.label(an||(an=Object(x.a)(["\n  display: block;\n  padding-bottom: 15px;\n"]))),In=f.a.input(rn||(rn=Object(x.a)(["\n  width: 100%;\n  font-size: 18px;\n  padding: 5px;\n  margin-bottom: 15px;\n  outline: none;\n  border-radius: 5px;\n  border: 1px solid #000;\n"]))),Dn=f.a.div(cn||(cn=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n"]))),Ln=f.a.p(on||(on=Object(x.a)(["\n  color: red;\n  font-size: 18px;\n"]))),En=f.a.button(sn||(sn=Object(x.a)(["\n  padding: 15px 25px;\n  border-radius: 5px;\n  box-shadow: none;\n  border: 1px solid #aa14f0;\n  background: #fff;\n  margin-left: 30px;\n  margin-bottom: 15px;\n  &:hover {\n    background: #aa14f0;\n    color: #fff;\n    cursor: pointer;\n  }\n"]))),Jn=Object(f.a)(h.b)(dn||(dn=Object(x.a)(["\n  margin-top: 15px;\n  margin-bottom: 15px;\n  padding: 10px 0;\n  display: block;\n  text-align: center;\n  text-decoration: none;\n  color: red;\n  font-size: 18px;\n"])));function Nn(){var n=Object(p.useContext)(g).setUser,e=Object(O.f)(),t=Object(p.useState)(""),a=Object(l.a)(t,2),r=a[0],c=a[1],o=Object(p.useState)(""),i=Object(l.a)(o,2),s=i[0],d=i[1],b=Object(p.useState)(""),u=Object(l.a)(b,2),j=u[0],x=u[1],f=Object(p.useState)(""),h=Object(l.a)(f,2),m=h[0],w=h[1];return Object(E.jsx)(Cn,{children:Object(E.jsxs)(zn,{onSubmit:function(t){if(t.preventDefault(),!r||!s||!j)return w("\u8cc7\u6599\u4e0d\u9f4a\u5168");I(r,j,s).then((function(t){if(0===t.ok)return"User exists, please login or change username"===t.message?w("\u5e33\u865f\u5df2\u5b58\u5728"):w(t.message.toString());v(t.token),D().then((function(t){if(1!==t.ok)return localStorage.removeItem("token"),w(t.toString());n(t.data),e.push("/")}))}))},children:[Object(E.jsx)(Pn,{children:"\u8a3b\u518a"}),Object(E.jsx)(Fn,{htmlFor:"username",children:"\u5e33\u865f"}),Object(E.jsx)(In,{type:"text",id:"username",value:r,onChange:function(n){c(n.target.value)}}),Object(E.jsx)(Fn,{htmlFor:"nickname",children:"\u66b1\u7a31"}),Object(E.jsx)(In,{type:"text",id:"nickname",value:s,onChange:function(n){d(n.target.value)}}),Object(E.jsx)(Fn,{htmlFor:"password",children:"\u5bc6\u78bc"}),Object(E.jsx)(In,{type:"password",id:"password",value:j,onChange:function(n){x(n.target.value)}}),Object(E.jsxs)(Dn,{children:[m&&Object(E.jsx)(Ln,{children:m}),Object(E.jsx)(En,{children:"\u8a3b\u518a"})]}),Object(E.jsx)("hr",{}),Object(E.jsx)(Jn,{to:"/login",children:"\u524d\u5f80\u767b\u5165"})]})})}var Tn,Un,Bn,$n,An,_n,Mn,Rn,Xn=f.a.div(mn||(mn=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 15px;\n  min-height: calc(100vh - 64px);\n"]))),qn=f.a.div(vn||(vn=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n  padding: 10px;\n"]))),Gn=f.a.h1(wn||(wn=Object(x.a)(["\n  font-size: 32px;\n  padding-bottom: 10px;\n  word-wrap: break-word;\n"]))),Hn=f.a.p(yn||(yn=Object(x.a)(["\n  padding-bottom: 20px;\n"]))),Kn=f.a.div(kn||(kn=Object(x.a)(["\n  width: 80%;\n  border: 1px solid #bc8cf2;\n  border-radius: 5px;\n  padding: 20px;\n"]))),Qn=f.a.p(Sn||(Sn=Object(x.a)(["\n  white-space: pre-wrap;\n  word-wrap: break-word;\n"])));function Vn(n){var e=n.post;return Object(E.jsx)(qn,{children:Object(E.jsxs)(Kn,{children:[Object(E.jsx)(Gn,{children:e[0].title}),Object(E.jsx)(Hn,{children:new Date(e[0].createdAt).toLocaleString()}),Object(E.jsx)(Qn,{children:e[0].body})]})})}function Wn(){var n=Object(O.h)().id,e=Object(p.useState)(),t=Object(l.a)(e,2),a=t[0],r=t[1];return Object(p.useEffect)((function(){P(n).then((function(n){return r(n)}))}),[n]),Object(E.jsx)(Xn,{children:a&&Object(E.jsx)(Vn,{post:a})})}var Yn,Zn,ne,ee,te,ae,re,ce=f.a.div(Tn||(Tn=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 15px;\n  margin-bottom: 30px;\n  display: flex;\n  justify-content: center;\n  align-items: baseline;\n  padding: 15px;\n  min-height: calc(100vh - 64px);\n"]))),oe=f.a.form(Un||(Un=Object(x.a)(["\n  width: 100%;\n  padding: 15px;\n  border: 1px solid #bc8cf2;\n  border-radius: 5px;\n"]))),ie=f.a.label(Bn||(Bn=Object(x.a)(["\n  display: block;\n  padding-bottom: 15px;\n"]))),se=f.a.input($n||($n=Object(x.a)(["\n  width: 100%;\n  font-size: 18px;\n  padding: 5px;\n  margin-bottom: 15px;\n  outline: none;\n  border: 1px solid #000;\n  border-radius: 5px;\n"]))),de=f.a.textarea(An||(An=Object(x.a)(["\n  width: 100%;\n  height: 50vh;\n  font-size: 18px;\n  padding: 5px;\n  resize: none;\n  margin-bottom: 15px;\n  outline: none;\n  border: 1px solid #000;\n  border-radius: 5px;\n"]))),be=f.a.div(_n||(_n=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n"]))),pe=f.a.p(Mn||(Mn=Object(x.a)(["\n  color: red;\n  font-size: 18px;\n"]))),ue=f.a.button(Rn||(Rn=Object(x.a)(["\n  padding: 15px 25px;\n  border-radius: 5px;\n  box-shadow: none;\n  border: 1px solid #aa14f0;\n  background: #fff;\n  margin-left: 30px;\n  &:hover {\n    background: #aa14f0;\n    color: #fff;\n    cursor: pointer;\n  }\n"])));function je(){var n=Object(O.f)(),e=Object(p.useState)(""),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(p.useState)(""),o=Object(l.a)(c,2),i=o[0],s=o[1],d=Object(p.useState)(""),b=Object(l.a)(d,2),u=b[0],j=b[1];return Object(E.jsx)(ce,{children:Object(E.jsxs)(oe,{onSubmit:function(e){if(e.preventDefault(),!a||!i)return j("\u8cc7\u6599\u4e0d\u9f4a\u5168");L(a,i).then((function(e){if(0===e.ok)return j(e.message.toString());n.push("/")}))},children:[Object(E.jsx)(ie,{htmlFor:"title",children:"\u6a19\u984c"}),Object(E.jsx)(se,{type:"text",id:"title",value:a,onChange:function(n){r(n.target.value)}}),Object(E.jsx)(ie,{htmlFor:"content",children:"\u5167\u5bb9"}),Object(E.jsx)(de,{id:"content",value:i,onChange:function(n){s(n.target.value)}}),Object(E.jsxs)(be,{children:[u&&Object(E.jsx)(pe,{children:u}),Object(E.jsx)(ue,{children:"\u63d0\u4ea4"})]})]})})}var le,xe=f.a.div(Yn||(Yn=Object(x.a)(["\n  height: 64px;\n  background: #fff;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid #d0a8fd67;\n  /* padding: 0 32px; */\n  margin: 0 auto;\n"]))),fe=f.a.div(Zn||(Zn=Object(x.a)(["\n  margin: 0 auto;\n  max-width: 1024px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n"]))),he=Object(f.a)(h.b)(ne||(ne=Object(x.a)(["\n  font-size: 32px;\n  font-weight: bold;\n  text-decoration: none;\n  color: #000;\n  position: absolute;\n  left: 50%;\n  transform: translateX(-50%);\n"]))),Oe=f.a.div(ee||(ee=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  height: 64px;\n"]))),ge=Object(f.a)(h.b)(te||(te=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ","\n  &:hover {\n    background: #d0a8fd67;\n  }\n"])),(function(n){return n.$active&&"\n    background: #d0a8fd52;\n  "})),me=f.a.a(ae||(ae=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n  &:hover {\n    background: #d0a8fd67;\n  }\n"]))),ve=f.a.div(re||(re=Object(x.a)(["\n  display: flex;\n  align-items: center;\n"])));function we(){var n=Object(O.g)(),e=Object(p.useContext)(g),t=e.user,a=e.setUser;return Object(E.jsx)(xe,{children:Object(E.jsxs)(fe,{children:[Object(E.jsx)(ve,{children:Object(E.jsxs)(Oe,{children:[Object(E.jsx)(ge,{to:"/",$active:"/"===n.pathname,children:"\u9996\u9801"}),t&&Object(E.jsx)(ge,{to:"/new-post",$active:"/new-post"===n.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})}),Object(E.jsx)(he,{to:"/",children:"\u6211\u7684React\u90e8\u843d\u683c"}),Object(E.jsxs)(Oe,{children:[!t&&Object(E.jsx)(ge,{to:"/login",$active:"/login"===n.pathname,children:"\u767b\u5165"}),t&&Object(E.jsx)(me,{onClick:function(){localStorage.removeItem("token"),a(null)},children:"\u767b\u51fa"})]})]})})}var ye=f.a.div(le||(le=Object(x.a)(["\n  padding-top: 64px;\n  background: #eeeeee78;\n"])));var ke=function(){var n=Object(p.useState)(null),e=Object(l.a)(n,2),t=e[0],a=e[1],r=w();return Object(p.useLayoutEffect)((function(){r&&D().then((function(n){1!==n.ok&&localStorage.removeItem("token"),a(n.data)}))}),[r]),Object(E.jsx)(g.Provider,{value:{user:t,setUser:a},children:Object(E.jsx)(ye,{children:Object(E.jsxs)(h.a,{children:[Object(E.jsx)(we,{}),Object(E.jsxs)(O.c,{children:[Object(E.jsx)(O.a,{exact:!0,path:"/",children:Object(E.jsx)(Z,{})}),Object(E.jsx)(O.a,{path:"/login",children:Object(E.jsx)(gn,{})}),Object(E.jsx)(O.a,{path:"/register",children:Object(E.jsx)(Nn,{})}),Object(E.jsx)(O.a,{path:"/post/:id",children:Object(E.jsx)(Wn,{})}),Object(E.jsx)(O.a,{path:"/new-post",children:Object(E.jsx)(je,{})})]})]})})})},Se=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,44)).then((function(e){var t=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;t(n),a(n),r(n),c(n),o(n)}))};j.a.render(Object(E.jsx)(ke,{}),document.getElementById("root")),Se()}},[[43,1,2]]]);
//# sourceMappingURL=main.ed440f5c.chunk.js.map
(this["webpackJsonpreact-blog"]=this["webpackJsonpreact-blog"]||[]).push([[0],{28:function(n,e,t){},29:function(n,e,t){},30:function(n,e,t){},43:function(n,e,t){"use strict";t.r(e);var a,r,c,o,i,s,b,d,j=t(0),p=t(19),u=t.n(p),l=(t(28),t(29),t(5)),x=t(2),f=(t(30),t(3)),O=t(7),h=t(4),g=Object(j.createContext)(null),m="token",v=function(n){localStorage.setItem(m,n)},w=function(){return localStorage.getItem(m)},y=t(9),k=t.n(y),S=t(10),z="https://student-json-api.lidemy.me",C=function(){var n=Object(S.a)(k.a.mark((function n(){var e,t;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(z,"/posts?_sort=createdAt&_order=desc"));case 2:return e=n.sent,n.next=5,e.json();case 5:return t=n.sent,n.abrupt("return",t);case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),P=function(){var n=Object(S.a)(k.a.mark((function n(e){var t,a;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(z,"/posts?id=").concat(e));case 2:return t=n.sent,n.next=5,t.json();case 5:return a=n.sent,n.abrupt("return",a);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),F=function(){var n=Object(S.a)(k.a.mark((function n(e,t){var a;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(z,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,password:t})});case 2:return a=n.sent,n.next=5,a.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),I=function(){var n=Object(S.a)(k.a.mark((function n(e,t,a){var r;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(z,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:e,nickname:t,password:a})});case 2:return r=n.sent,n.next=5,r.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}(),D=function(){var n=Object(S.a)(k.a.mark((function n(){var e,t,a;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=w(),n.next=3,fetch("".concat(z,"/me"),{headers:{authorization:"Bearer ".concat(e)}});case 3:return t=n.sent,n.next=6,t.json();case 6:return a=n.sent,n.abrupt("return",a);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),L=function(){var n=Object(S.a)(k.a.mark((function n(e,t){var a,r;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=w(),n.next=3,fetch("".concat(z,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(a),"content-type":"application/json"},body:JSON.stringify({title:e,body:t})});case 3:return r=n.sent,n.next=6,r.json();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),E=t(1),J=f.a.div(a||(a=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n"]))),N=f.a.div(r||(r=Object(x.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]))),T=Object(f.a)(O.b)(c||(c=Object(x.a)(["\n  width: 80%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]))),U=f.a.div(o||(o=Object(x.a)(["\n  /* width: 20%; */\n  color: rgba(0, 0, 0, 0.8);\n"])));function B(n){var e=n.post;return Object(E.jsxs)(N,{children:[Object(E.jsx)(T,{to:"/post/".concat(e.id),children:e.title}),Object(E.jsx)(U,{children:new Date(e.createdAt).toLocaleString()})]})}function $(n){var e=n.num,t=n.totalPage,a=n.handlePrePageChage,r=n.handleNextPageChage;return Object(E.jsxs)(V,{children:[1!==e&&Object(E.jsx)(W,{onClick:a,children:"\uff1c"}),Object(E.jsxs)(X,{children:[Object(E.jsx)(Y,{children:e})," / ",t]}),e!==t&&Object(E.jsx)(W,{onClick:r,children:"\uff1e"})]})}var A,_,M,R,q,G,H,K,Q,V=f.a.div(i||(i=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 20px;\n  margin-top: 20px;\n"]))),W=f.a.button(s||(s=Object(x.a)(["\n  border: none;\n  color: red;\n  background: none;\n  font-size: 20px;\n  padding: 15px;\n  cursor: pointer;\n"]))),X=f.a.p(b||(b=Object(x.a)([""]))),Y=f.a.span(d||(d=Object(x.a)(["\n  color: #b28b00;\n"])));function Z(){var n=Object(j.useState)([]),e=Object(l.a)(n,2),t=e[0],a=e[1],r=Object(j.useState)(1),c=Object(l.a)(r,2),o=c[0],i=c[1],s=Object(j.useState)([]),b=Object(l.a)(s,2),d=b[0],p=b[1],u=t.length,x=Math.ceil(u/10),f=Object(j.useCallback)((function(n,e){p(t.slice(5*(n-1),5*(n-1)+e))}),[t]);Object(j.useLayoutEffect)((function(){C().then((function(n){return a(n)}))}),[]),Object(j.useEffect)((function(){f(o,10)}),[f,o]);return Object(E.jsxs)(J,{children:[d.map((function(n){return Object(E.jsx)(B,{post:n},n.id)})),Object(E.jsx)($,{num:o,totalPage:x,handlePrePageChage:function(){i(o-1)},handleNextPageChage:function(){i(o+1)}})]})}var nn,en,tn,an,rn,cn,on,sn,bn,dn=f.a.div(A||(A=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 15px;\n  margin-bottom: 30px;\n  display: flex;\n  justify-content: center;\n"]))),jn=f.a.form(_||(_=Object(x.a)(["\n  width: 50%;\n  padding: 30px 15px 15px;\n  border: 1px solid #000;\n"]))),pn=f.a.h2(M||(M=Object(x.a)(["\n  border-left: 5px solid #e56bfa;\n  font-size: 28px;\n  font-weight: bold;\n  padding-left: 15px;\n  margin-bottom: 30px;\n"]))),un=f.a.label(R||(R=Object(x.a)(["\n  display: block;\n  padding-bottom: 15px;\n"]))),ln=f.a.input(q||(q=Object(x.a)(["\n  width: 100%;\n  font-size: 18px;\n  padding: 5px;\n  margin-bottom: 15px;\n  outline: none;\n"]))),xn=f.a.div(G||(G=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n"]))),fn=f.a.p(H||(H=Object(x.a)(["\n  color: red;\n  font-size: 18px;\n"]))),On=f.a.button(K||(K=Object(x.a)(["\n  padding: 15px 25px;\n  border-radius: 5px;\n  box-shadow: none;\n  border: 1px solid #000;\n  background: #fff;\n  margin-left: 30px;\n  margin-bottom: 15px;\n"]))),hn=Object(f.a)(O.b)(Q||(Q=Object(x.a)(["\n  margin-top: 15px;\n  margin-bottom: 15px;\n  padding: 10px 0;\n  display: block;\n  text-align: center;\n  text-decoration: none;\n  color: red;\n  font-size: 18px;\n"])));function gn(){var n=Object(j.useContext)(g),e=(n.user,n.setUser),t=Object(h.f)(),a=Object(j.useState)(""),r=Object(l.a)(a,2),c=r[0],o=r[1],i=Object(j.useState)(""),s=Object(l.a)(i,2),b=s[0],d=s[1],p=Object(j.useState)(""),u=Object(l.a)(p,2),x=u[0],f=u[1];return Object(E.jsx)(dn,{children:Object(E.jsxs)(jn,{onSubmit:function(n){n.preventDefault(),F(c,b).then((function(n){if(0===n.ok)return f(n.message);v(n.token),D().then((function(n){if(1!==n.ok)return localStorage.removeItem("token"),f(n.toString());e(n.data),t.push("/")}))}))},children:[Object(E.jsx)(pn,{children:"\u767b\u5165"}),Object(E.jsx)(un,{htmlFor:"username",children:"\u5e33\u865f"}),Object(E.jsx)(ln,{type:"text",id:"username",value:c,onChange:function(n){o(n.target.value)}}),Object(E.jsx)(un,{htmlFor:"password",children:"\u5bc6\u78bc"}),Object(E.jsx)(ln,{type:"password",id:"password",value:b,onChange:function(n){d(n.target.value)}}),Object(E.jsxs)(xn,{children:[x&&Object(E.jsx)(fn,{children:x}),Object(E.jsx)(On,{children:"\u8a3b\u518a"})]}),Object(E.jsx)("hr",{}),Object(E.jsx)(hn,{to:"/register",children:"\u524d\u5f80\u8a3b\u518a"})]})})}var mn,vn,wn,yn,kn,Sn,zn=f.a.div(nn||(nn=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 15px;\n  margin-bottom: 30px;\n  display: flex;\n  justify-content: center;\n"]))),Cn=f.a.form(en||(en=Object(x.a)(["\n  width: 50%;\n  padding: 30px 15px 15px;\n  border: 1px solid #000;\n"]))),Pn=f.a.h2(tn||(tn=Object(x.a)(["\n  border-left: 5px solid #e56bfa;\n  font-size: 28px;\n  font-weight: bold;\n  padding-left: 15px;\n  margin-bottom: 30px;\n"]))),Fn=f.a.label(an||(an=Object(x.a)(["\n  display: block;\n  padding-bottom: 15px;\n"]))),In=f.a.input(rn||(rn=Object(x.a)(["\n  width: 100%;\n  font-size: 18px;\n  padding: 5px;\n  margin-bottom: 15px;\n  outline: none;\n"]))),Dn=f.a.div(cn||(cn=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n"]))),Ln=f.a.p(on||(on=Object(x.a)(["\n  color: red;\n  font-size: 18px;\n"]))),En=f.a.button(sn||(sn=Object(x.a)(["\n  padding: 15px 25px;\n  border-radius: 5px;\n  box-shadow: none;\n  border: 1px solid #000;\n  background: #fff;\n  margin-left: 30px;\n  margin-bottom: 15px;\n"]))),Jn=Object(f.a)(O.b)(bn||(bn=Object(x.a)(["\n  margin-top: 15px;\n  margin-bottom: 15px;\n  padding: 10px 0;\n  display: block;\n  text-align: center;\n  text-decoration: none;\n  color: red;\n  font-size: 18px;\n"])));function Nn(){var n=Object(j.useContext)(g),e=(n.user,n.setUser),t=Object(h.f)(),a=Object(j.useState)(""),r=Object(l.a)(a,2),c=r[0],o=r[1],i=Object(j.useState)(""),s=Object(l.a)(i,2),b=s[0],d=s[1],p=Object(j.useState)(""),u=Object(l.a)(p,2),x=u[0],f=u[1],O=Object(j.useState)(""),m=Object(l.a)(O,2),w=m[0],y=m[1];return Object(E.jsx)(zn,{children:Object(E.jsxs)(Cn,{onSubmit:function(n){if(n.preventDefault(),!c||!b||!x)return y("\u8cc7\u6599\u4e0d\u9f4a\u5168");I(c,x,b).then((function(n){if(0===n.ok)return"User exists, please login or change username"===n.message?y("\u5e33\u865f\u5df2\u5b58\u5728"):y(n.message.toString());v(n.token),D().then((function(n){if(1!==n.ok)return localStorage.removeItem("token"),y(n.toString());e(n.data),t.push("/")}))}))},children:[Object(E.jsx)(Pn,{children:"\u8a3b\u518a"}),Object(E.jsx)(Fn,{htmlFor:"username",children:"\u5e33\u865f"}),Object(E.jsx)(In,{type:"text",id:"username",value:c,onChange:function(n){o(n.target.value)}}),Object(E.jsx)(Fn,{htmlFor:"nickname",children:"\u66b1\u7a31"}),Object(E.jsx)(In,{type:"text",id:"nickname",value:b,onChange:function(n){d(n.target.value)}}),Object(E.jsx)(Fn,{htmlFor:"password",children:"\u5bc6\u78bc"}),Object(E.jsx)(In,{type:"password",id:"password",value:x,onChange:function(n){f(n.target.value)}}),Object(E.jsxs)(Dn,{children:[w&&Object(E.jsx)(Ln,{children:w}),Object(E.jsx)(En,{children:"\u8a3b\u518a"})]}),Object(E.jsx)("hr",{}),Object(E.jsx)(Jn,{to:"/login",children:"\u524d\u5f80\u767b\u5165"})]})})}var Tn,Un,Bn,$n,An,_n,Mn,Rn,qn=f.a.div(mn||(mn=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 15px;\n  border: 1px solid #000;\n  padding: 10px;\n"]))),Gn=f.a.div(vn||(vn=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n"]))),Hn=f.a.h1(wn||(wn=Object(x.a)(["\n  font-size: 32px;\n  padding-bottom: 10px;\n  word-wrap: break-word;\n"]))),Kn=f.a.p(yn||(yn=Object(x.a)(["\n  padding-bottom: 20px;\n"]))),Qn=f.a.div(kn||(kn=Object(x.a)(["\n  width: 70%;\n"]))),Vn=f.a.p(Sn||(Sn=Object(x.a)(["\n  white-space: pre-wrap;\n  word-wrap: break-word;\n"])));function Wn(n){var e=n.post;return Object(E.jsx)(Gn,{children:Object(E.jsxs)(Qn,{children:[Object(E.jsx)(Hn,{children:e[0].title}),Object(E.jsx)(Kn,{children:new Date(e[0].createdAt).toLocaleString()}),Object(E.jsx)(Vn,{children:e[0].body})]})})}function Xn(){var n=Object(h.h)().id,e=Object(j.useState)(),t=Object(l.a)(e,2),a=t[0],r=t[1];return Object(j.useEffect)((function(){P(n).then((function(n){return r(n)}))}),[n]),Object(E.jsx)(qn,{children:a&&Object(E.jsx)(Wn,{post:a})})}var Yn,Zn,ne,ee,te,ae,re=f.a.div(Tn||(Tn=Object(x.a)(["\n  max-width: 1024px;\n  margin: 0 auto;\n  margin-top: 15px;\n  margin-bottom: 30px;\n  border: 1px solid #000;\n  display: flex;\n  justify-content: center;\n  padding: 15px;\n"]))),ce=f.a.form(Un||(Un=Object(x.a)(["\n  width: 80%;\n"]))),oe=f.a.label(Bn||(Bn=Object(x.a)(["\n  display: block;\n  padding-bottom: 15px;\n"]))),ie=f.a.input($n||($n=Object(x.a)(["\n  width: 100%;\n  font-size: 18px;\n  padding: 5px;\n  margin-bottom: 15px;\n  outline: none;\n"]))),se=f.a.textarea(An||(An=Object(x.a)(["\n  width: 100%;\n  height: 50vh;\n  font-size: 18px;\n  padding: 5px;\n  resize: none;\n  margin-bottom: 15px;\n  outline: none;\n"]))),be=f.a.div(_n||(_n=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n"]))),de=f.a.p(Mn||(Mn=Object(x.a)(["\n  color: red;\n  font-size: 18px;\n"]))),je=f.a.button(Rn||(Rn=Object(x.a)(["\n  padding: 15px 25px;\n  border-radius: 5px;\n  box-shadow: none;\n  border: 1px solid #000;\n  background: #fff;\n  margin-left: 30px;\n"])));function pe(){var n=Object(h.f)(),e=Object(j.useState)(""),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(j.useState)(""),o=Object(l.a)(c,2),i=o[0],s=o[1],b=Object(j.useState)(""),d=Object(l.a)(b,2),p=d[0],u=d[1];return Object(E.jsx)(re,{children:Object(E.jsxs)(ce,{onSubmit:function(e){if(e.preventDefault(),!a||!i)return u("\u8cc7\u6599\u4e0d\u9f4a\u5168");L(a,i).then((function(e){if(0===e.ok)return u(e.message.toString());n.push("/")}))},children:[Object(E.jsx)(oe,{htmlFor:"title",children:"\u6a19\u984c"}),Object(E.jsx)(ie,{type:"text",id:"title",value:a,onChange:function(n){r(n.target.value)}}),Object(E.jsx)(oe,{htmlFor:"content",children:"\u5167\u5bb9"}),Object(E.jsx)(se,{id:"content",value:i,onChange:function(n){s(n.target.value)}}),Object(E.jsxs)(be,{children:[p&&Object(E.jsx)(de,{children:p}),Object(E.jsx)(je,{children:"\u63d0\u4ea4"})]})]})})}var ue,le=f.a.div(Yn||(Yn=Object(x.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  background: #fff;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0 32px;\n  box-sizing: border-box;\n"]))),xe=f.a.div(Zn||(Zn=Object(x.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]))),fe=f.a.div(ne||(ne=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  height: 64px;\n"]))),Oe=Object(f.a)(O.b)(ee||(ee=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ","\n"])),(function(n){return n.$active&&"\n    background: rgba(0, 0, 0, 0.1);\n  "})),he=f.a.a(te||(te=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n"]))),ge=f.a.div(ae||(ae=Object(x.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"])),fe);function me(){var n=Object(h.g)(),e=Object(j.useContext)(g),t=e.user,a=e.setUser;return Object(E.jsxs)(le,{children:[Object(E.jsxs)(ge,{children:[Object(E.jsx)(xe,{children:"\u6211\u7684React\u90e8\u843d\u683c"}),Object(E.jsxs)(fe,{children:[Object(E.jsx)(Oe,{to:"/",$active:"/"===n.pathname,children:"\u9996\u9801"}),t&&Object(E.jsx)(Oe,{to:"/new-post",$active:"/new-post"===n.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(E.jsxs)(fe,{children:[!t&&Object(E.jsx)(Oe,{to:"/login",$active:"/login"===n.pathname,children:"\u767b\u5165"}),t&&Object(E.jsx)(he,{onClick:function(){localStorage.removeItem("token"),a(null)},children:"\u767b\u51fa"})]})]})}var ve=f.a.div(ue||(ue=Object(x.a)(["\n  padding-top: 64px;\n"])));var we=function(){var n=Object(j.useState)(null),e=Object(l.a)(n,2),t=e[0],a=e[1],r=w();return Object(j.useLayoutEffect)((function(){r&&D().then((function(n){1!==n.ok&&localStorage.removeItem("token"),a(n.data)}))}),[r]),Object(E.jsx)(g.Provider,{value:{user:t,setUser:a},children:Object(E.jsx)(ve,{children:Object(E.jsxs)(O.a,{children:[Object(E.jsx)(me,{}),Object(E.jsxs)(h.c,{children:[Object(E.jsx)(h.a,{exact:!0,path:"/",children:Object(E.jsx)(Z,{})}),Object(E.jsx)(h.a,{path:"/login",children:Object(E.jsx)(gn,{})}),Object(E.jsx)(h.a,{path:"/register",children:Object(E.jsx)(Nn,{})}),Object(E.jsx)(h.a,{path:"/post/:id",children:Object(E.jsx)(Xn,{})}),Object(E.jsx)(h.a,{path:"/new-post",children:Object(E.jsx)(pe,{})})]})]})})})},ye=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,44)).then((function(e){var t=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;t(n),a(n),r(n),c(n),o(n)}))};u.a.render(Object(E.jsx)(we,{}),document.getElementById("root")),ye()}},[[43,1,2]]]);
//# sourceMappingURL=main.f855c569.chunk.js.map